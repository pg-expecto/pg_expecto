# pg_expecto - статистический анализ производительности и ожиданий СУБД PostgreSQL.
Комплекс **pg_expecto**, предназначен для глубокого статистического анализа и тестирования производительности СУБД. Релиз знаменует собой появление мощного и свободно распространяемого инструмента для администраторов баз данных и разработчиков.

Основная задача **pg_expecto** — предоставить комплексный инструментарий для выявления узких мест и оптимизации работы PostgreSQL. В отличие от некоторых современных решений, pg_expecto сознательно сфокусирован на надежных и проверенных статистических методах, что обеспечивает полный контроль и прозрачность процесса анализа.

## Ключевые особенности pg_expecto
- **Всесторонний статистический и корреляционный анализ:** Выполнение глубокого анализа производительности PostgreSQL и событий ожидания (wait_event_type/wait_event), помогет установить корреляцию между внутренним состоянием СУБД и общей производительностью системы.
- **Мониторинг операционной системы:** **pg_expecto** выходит за рамки самой СУБД и включает в себя инструменты для сбора и анализа метрик операционной системы с помощью утилит vmstat и iostat. Это позволяет напрямую увязать нагрузку на диск, память и процессор с поведением базы данных.
- **Встроенное нагрузочное тестирование:** Пользователи могут проводить нагрузочные тесты непосредственно с помощью **pg_expecto**, оценивая, как база данных ведет себя под давлением, и определяя пределы ее производительности.
- **Построение отчетов для Excel:** Развитые возможности построения отчетов позволяют легко экспортировать результаты анализа в форматы, совместимые с Microsoft Excel, что упрощает дальнейшую обработку, визуализацию и представление данных руководству.
- **Обширная база знаний:** В распоряжение пользователей передан большой объем материалов по результатам экспериментов с проектом [pg_hazel](https://dzen.ru/suite/009d4a06-f053-4377-8fdc-76721bf79c50), служащий ценным источником знаний и практических примеров для проведения эффективного анализа.
- **Проактивный мониторинг:** Формирование репрезентативных профилей производительности систем наблюдения посредством разработки стандартизированных файлов метрических данных. Регистрация события снижения производительности системы управления базами данных служит триггером инициирования стандартных и приоритетных инцидентов реагирования.
- **Интеграция с нейросетью:** Автоматическое конструирование вводных инструкций для искусственной нейронной сети, предназначенных для осуществления семантического анализа рекомендаций относительно минимизации задержек обработки в системах управления базами данных и улучшения структуры сложных SQL-запросов, предварительно выявленных методами корреляционной аналитики событий ухудшения производительности СУБД.
- **Версия 4.0** обеспечивает возможность кастомизации сценариев тестирования и поддерживает использование выделенного экземпляра базы данных в качестве тестового полигона для проведения нагрузочного тестирования.
- **Версия 5.0** подготовка входных файлов для формирования отчетов по нагрузочному тестированию с использованием нейросети 

## Контакты
- Ринат Сунгатуллин **kznalp@yandex.ru**
- [Дзен-канал](https://dzen.ru/kznalp) : https://dzen.ru/kznalp
- [Телеграм-канал](https://t.me/pg_hazel) : https://t.me/pg_hazel

## Статус проекта
Текущая версия: 5

## Установка (Installation)
### ВАЖНО
Для работы **pg_expecto** требуются установленные библиотеки расширений **pg_stat_statements** и **pg_wait_sampling**

Значение параметра **shared_preload_libraries** должно быть:

shared_preload_libraries=‘pg_stat_statements , pg_wait_sampling’

**Порядок библиотек ВАЖЕН**
### Инсталляция
1. Распаковать zip-архив проекта(*pg_expecto-main.zip*) : в результате будет подготовлена папка: **pg_expecto-main**
2. Скопировать содержимое на целевой сервер СУБД в папку: **/tmp/pg_expecto**
3. Используя учетную запись *postgres*, на целевом сервере СУБД cоздать сервисную папку: **mkdir /postgres/pg_expecto**
4. Скопировать инсталлятор: **cp /tmp/pg_expecto/pg_expecto_install.sh /postgres/pg_expecto/**
5. Перейти в папку для начала инсталляции: **cd /postgres/pg_expecto**
6. Подготовить скрипт инсталлятора: **chmod 750 pg_expecto_install.sh**
7. Запустить инсталлятор: **./pg_expecto_install.sh**

### Мониторинг работоспособности pg_expecto
**tail -f /postgres/pg_expecto/sh/pg_expecto.log**

# Использование pg_expecto

- [PG_EXPECTO: Нагрузочное тестирование СУБД PostgreSQL](https://dzen.ru/a/aO90kwEztw-GQVba)
- [PG_EXPECTO: Аудит производительности инфраструктуры при нагрузочном тестировании СУБД PostgreSQL](https://dzen.ru/a/aPmymHYePCkukP3p)
- [Типовой шаблон расследования инцидентов PostgreSQL с помощью pg_expecto. Часть 1: Анализ на уровне СУБД](https://dzen.ru/a/aPyyCU9YvyBsSWJh)
- [Типовой шаблон расследования инцидентов PostgreSQL с помощью pg_expecto. Часть 2: Детальный разбор инфраструктуры сервера](https://dzen.ru/a/aPzDp3M5O3zp2aZ1)
- [Использование PG_EXPECTO для выявления проблемных SQL запросов при анализе инцидента производительности СУБД PostgreSQL](https://dzen.ru/a/aQX74beixXl2XCfR?share_to=link)
- [PG_EXPECTO : Настройка сценариев нагрузочного тестирования СУБД PostgreSQL](https://dzen.ru/a/aQsuqvClBDUYiIA6?share_to=link)
- [PG_EXPECTO 4 + Демобаза 2.0 : использование тестовой базы данных для нагрузочного тестирования СУБД](https://dzen.ru/a/aRMGMa7auy4kKuPk?share_to=link)
- [PG_EXPECTO: Анализ влияния размера shared_buffers на производительность СУБД PostgreSQL](https://habr.com/p/976344/)
- [PG_EXPECTO: work_mem: мифы и реальность производительности PostgreSQL](https://dzen.ru/a/aULBju4l2iRx7gNd)
- [PG_EXPECTO : Использование нейросети для анализа результатов нагрузочного тестирования СУБД PostgreSQL](https://dzen.ru/a/aVkK0LKXRRwLXNu3?share_to=link)

